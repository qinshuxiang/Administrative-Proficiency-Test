## 排列组合

<video src="./资源/排列组合.mp4" autoplay="false"></video>


### 排列

假设有 **5 本不同的书**，我们想从中**选择 3 本书并排列成一行**，问有多少种不同的排列方式？

1. **已知条件**：总数 $n = 5$，选择数 $r = 3$。
2. **排列公式**：$A(n, r) = \frac{n!}{(n-r)!}$。

带入数值：
$$
A(5, 3) = \frac{5!}{(5-3)!} = \frac{5 \times 4 \times 3 \times 2 \times 1}{2 \times 1} = 5 \times 4 \times 3 = 60
$$
**答案**：有 **60 种排列方式**。



### 组合

假设有 **5 个不同的朋友**，我们想从中**选择 3 个朋友组成一支队伍**，问有多少种不同的组合方式？

1. **已知条件**：总数 $n = 5$，选择数 $r = 3$。
2. **组合公式**：$C(n, r) = \frac{n!}{r! \cdot (n-r)!}$。

带入数值：
$$
C(5, 3) = \frac{5!}{3! \cdot (5-3)!} = \frac{5 \times 4 \times 3 \times 2 \times 1}{(3 \times 2 \times 1) \cdot (2 \times 1)} = \frac{120}{12} = 10
$$
**答案**：有 **10 种组合方式**。



## 不定方程

<video src="./资源/不定方程.mp4" autoplay="false"></video>

### 鸡兔同笼

已知方程 $7x + 8y = 45$，通过假设和调整来求解整数解。  

1. **假设 $x = 0$**：  
   - 将 $x = 0$ 代入方程：  $$7(0) + 8y = 45 \implies 8y = 45$$  
   - 观察结果：$y \approx 5.625$，接近整数 $6$，但多了 $3$。
   
2. **利用变量关系调整**：  
   - 每当 $x$ 增加 $1$，$7x$ 会增加 $7$，从而使总和减少 $7$；  
   - 每当 $y$ 减少 $1$，$8y$ 会减少 $8$，从而使总和减少 $8$；  
   - **所以每减少一个 $y$，增加一个 $x$，总和会减少 $1$，满足调整目标。**

3. **调整得解**：  
   - 当前多了 $3$，调整时让 $y$ 减少 $3$，即 $y = 6 - 3 = 3$，同时 $x$ 增加 $3$，即 $x = 0 + 3 = 3$。

4. **验证解**：  
   - 将 $x = 3, y = 3$ 代入方程：  $$7(3) + 8(3) = 21 + 24 = 45$$  
   - 方程成立。  

$x = 3, y = 3$ 是方程 $7x + 8y = 45$ 的整数解。

### 倍数特性

已知方程 $7x + 8y = 96$，利用倍数特性求解整数解。  

1. **观察倍数关系**：  
   - $8y$ 和 $96$ 都是 $8$ 的倍数，所以 $7x$ 也必须是 $8$ 的倍数。  
   - 由于 $7$ 和 $8$ 互质，$x$ 必须是 $8$ 的倍数。  

2. **令 $x = 8k$，代入方程**：  $$7(8k) + 8y = 96 \implies 56k + 8y = 96 \implies 8y = 96 - 56k \implies y = 12 - 7k$$  
   
3. **寻找整数解**：  
   - 当 $k = 1$，$x = 8, y = 5$。  
   - 进一步检查其他可能值，根据题意选择适当的 $k$ 值。

$x = 8, y = 5$ 是方程 $7x + 8y = 96$ 的一个整数解。

---

### **奇偶特性**

已知方程 $7x + 8y = 23$，利用奇偶特性判断解的存在性。  

1. **观察奇偶性**：  
   - $8y$ 一定是偶数；  
   - $7x$ 的奇偶性由 $x$ 决定，当 $x$ 为奇数时，$7x$ 是奇数，当 $x$ 为偶数时，$7x$ 是偶数。  
   - $23$ 是奇数，因此 $7x + 8y$ 的总和必须是奇数。  

2. **判断解的可能性**：  
   - $8y$ 是偶数，偶数加偶数为偶数，因此 $7x$ 必须是奇数，$x$ 必须是奇数。  
   - 进一步尝试具体值可以验证是否存在整数解。  

3. **进一步验证**：  
   - 假设 $x = 1$，代入得：  
     $$7(1) + 8y = 23 \implies 8y = 16 \implies y = 2$$  
   - 故解为 $x = 1, y = 2$。

$x = 1, y = 2$ 是方程 $7x + 8y = 23$ 的整数解。

### 结果调整

假设我们已经通过扩展欧几里得算法或其他方法找到了一个特解 $(x_0, y_0)$

比如对于方程 $6x + 5y = 99$，我们通过求解得到特解 $x_0 = 4$ 和 $y_0 = 15$。

在 $x_0 = 4$ 和 $y_0 = 15$ 的基础上，我们可以通过调整 $x$ 和 $y$ 来得到更多的解。根据方程的结构，每当 $x$ 增加 $b$，$y$ 就会减少 $a$，从而得到新的解。

从特解 $x = 4$ 和 $y = 15$ 开始：

- 通过增加 $b = 5$ 来得到新的 $x$：$x = 4 + 5 = 9$
- 同时，减少 $a = 6$ 来得到新的 $y$：$y = 15 - 6 = 9$

所以，$(x = 9, y = 9)$ 也是方程 $6x + 5y = 99$ 的一个解。

同理，$(x = 14, y = 3)$ 也是方程 $6x + 5y = 99$ 的一个解。

### 代码程序

```javascript
const readline = require("readline");

// 创建命令行界面
const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
});

// 扩展欧几里得算法求解gcd和对应的x, y
function gcdExtended(a, b) {
    if (b === 0) return { gcd: a, x: 1, y: 0 };
    const { gcd, x: x1, y: y1 } = gcdExtended(b, a % b);
    return {
        gcd,
        x: y1,
        y: x1 - Math.floor(a / b) * y1,
    };
}

// 调整解使其为正整数
function adjustSolution(a, b, gcd, m, { x, y }) {
    x *= m / gcd;
    y *= m / gcd;

    const kMinX = Math.ceil(-x * gcd / b);
    const kMinY = Math.ceil(-y * gcd / a);
    const kMin = Math.max(kMinX, kMinY);

    x += kMin * b / gcd;
    y -= kMin * a / gcd;

    return x >= 1 && y >= 1 ? { x, y } : null;
}

// 生成随机的丢番图方程，满足更复杂的要求
function generateEquation() {
    let a, b, m, gcd, x, y;

    while (true) {
        // 系数a和b随机生成，范围接近10
        a = Math.floor(Math.random() * 9) + 7; // 7到15的随机整数
        b = Math.floor(Math.random() * 9) + 7;

        // 计算gcd和初始解
        const result = gcdExtended(a, b);
        gcd = result.gcd;
        x = result.x;
        y = result.y;

        // 生成右侧m，确保它是x或y的倍数加一个偏移
        const multiplierX = Math.floor(Math.random() * 5) + 2; // 2到6的倍数
        const multiplierY = Math.floor(Math.random() * 5) + 2;
        m = gcd * (multiplierX * a + multiplierY * b);

        // 调整解为正整数
        const adjustedSolution = adjustSolution(a, b, gcd, m, result);
        if (adjustedSolution) {
            return { a, b, m, ...adjustedSolution };
        }
    }
}

// 检查用户解的正确性
function isSolutionCorrect(a, b, m, x, y) {
    return a * x + b * y === m && x >= 1 && y >= 1;
}

// 验证用户输入是否为两个正整数
function parseInput(input) {
    const [x, y] = input.split(" ").map(Number);
    if (!Number.isInteger(x) || !Number.isInteger(y) || x < 1 || y < 1) {
        return null;
    }
    return { x, y };
}

// 主函数
function startTraining() {
    console.log("不定方程训练");

    function nextEquation() {
        const { a, b, m, x, y } = generateEquation();
        console.log(`求解方程: ${a}x + ${b}y = ${m}`);

        function askForSolution() {
            rl.question("请输入你的解 (格式: x y, 用空格分隔): ", (input) => {
                const parsed = parseInput(input);

                if (!parsed) {
                    console.log("输入无效，请输入正整数对！(格式: x y)\n");
                    return askForSolution();
                }

                const { x: userX, y: userY } = parsed;
                if (isSolutionCorrect(a, b, m, userX, userY)) {
                    console.log("答案正确！下一题！\n");
                    nextEquation();
                } else {
                    console.log("答案错误，请再试一次！\n");
                    askForSolution();
                }
            });
        }

        askForSolution();
    }

    nextEquation();
}

// 启动程序
startTraining();
```

